name: Benchmark Master

on:
  workflow_dispatch:
  push:
    branches:
      - master

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
        with:
          path: "./yew"

      - run: pwd

      - run: ls ./yew/workflows/benchmark-run

      - uses: ./yew/workflows/benchmark-run
        id: benchmark

      - run: echo ${{ steps.benchmark.outputs.results }}
# {"framework":"baseline-keyed","keyed":true,"benchmark":"01_run1k","type":"cpu","min":175.313,"max":232.875,"mean":188.0121,"median":183.3795,"geometricMean":187.41571579204455,"standardDeviation":16.66508000747538,"values":[175.313,175.647,180.516,180.725,181.48,185.279,187.722,189.086,191.478,232.875]}{"framework":"target-keyed","keyed":true,"benchmark":"01_run1k","type":"cpu","min":179.49,"max":228.904,"mean":191.8154,"median":190.00799999999998,"geometricMean":191.35477355542594,"standardDeviation":14.552316311998046,"values":[179.49,180.738,181.109,182.696,188.2,191.816,192.596,194.888,197.717,228.904]}==================
# {"framework":"baseline-keyed","keyed":true,"benchmark":"02_replace1k","type":"cpu","min":200.978,"max":214.894,"mean":208.13490000000002,"median":207.9235,"geometricMean":208.0979561840069,"standardDeviation":4.140020811810275,"values":[200.978,205.688,205.947,205.958,207.556,208.291,208.611,208.916,214.51,214.894]}{"framework":"target-keyed","keyed":true,"benchmark":"02_replace1k","type":"cpu","min":203.973,"max":216.301,"mean":211.7887,"median":213.042,"geometricMean":211.76112703602237,"standardDeviation":3.5817662635446523,"values":[203.973,208.163,209.723,212.106,212.471,213.613,213.757,213.85,213.93,216.301]}==================
# {"framework":"baseline-keyed","keyed":true,"benchmark":"03_update10th1k_x16","type":"cpu","min":242.666,"max":463.701,"mean":405.07770000000005,"median":414.057,"geometricMean":399.4806744526019,"standardDeviation":63.34796616054677,"values":[242.666,386.86,395.861,396.261,398.639,429.475,436.905,443.672,456.737,463.701]}{"framework":"target-keyed","keyed":true,"benchmark":"03_update10th1k_x16","type":"cpu","min":356.402,"max":474.374,"mean":425.3487,"median":427.7495,"geometricMean":423.72023198285365,"standardDeviation":38.61105186644537,"values":[356.402,377.361,404.287,410.6,427.411,428.088,454.824,458.559,461.581,474.374]}==================
# {"framework":"baseline-keyed","keyed":true,"benchmark":"04_select1k","type":"cpu","min":75.173,"max":93.591,"mean":86.67550000000001,"median":86.366,"geometricMean":86.49481318513902,"standardDeviation":5.821921852408837,"values":[75.173,81.873,82.44,86.01,86.206,86.526,89.205,92.548,93.183,93.591]}{"framework":"target-keyed","keyed":true,"benchmark":"04_select1k","type":"cpu","min":77.768,"max":93.962,"mean":87.1122,"median":88.89150000000001,"geometricMean":86.9203884457425,"standardDeviation":6.0391666054919275,"values":[77.768,79.58,81.313,83.653,88.702,89.081,91.068,92.577,93.418,93.962]}==================
# {"framework":"baseline-keyed","keyed":true,"benchmark":"05_swap1k","type":"cpu","min":90.921,"max":104.91,"mean":98.1136,"median":96.8065,"geometricMean":97.97426386201425,"standardDeviation":5.518474048341826,"values":[90.921,92.068,93.351,94.666,95.966,97.647,103.14,104.094,104.373,104.91]}{"framework":"target-keyed","keyed":true,"benchmark":"05_swap1k","type":"cpu","min":87.707,"max":103.637,"mean":98.61549999999998,"median":99.667,"geometricMean":98.48222738456127,"standardDeviation":5.328845200103554,"values":[87.707,94.47,95.155,96.617,96.863,102.471,102.494,103.319,103.422,103.637]}==================
# {"framework":"baseline-keyed","keyed":true,"benchmark":"06_remove-one-1k","type":"cpu","min":30.928,"max":35.147,"mean":32.9989,"median":32.973,"geometricMean":32.96588704243365,"standardDeviation":1.5553480817989123,"values":[30.928,31.087,31.646,32.118,32.471,33.475,33.829,34.634,34.654,35.147]}{"framework":"target-keyed","keyed":true,"benchmark":"06_remove-one-1k","type":"cpu","min":29.126,"max":34.866,"mean":32.32639999999999,"median":32.7125,"geometricMean":32.260150705623786,"standardDeviation":2.159874955228246,"values":[29.126,29.175,30.242,31.968,32.507,32.918,33.588,34.385,34.489,34.866]}==================
# {"framework":"baseline-keyed","keyed":true,"benchmark":"07_create10k","type":"cpu","min":2562.824,"max":2805.269,"mean":2701.7815,"median":2729.8905,"geometricMean":2700.6123463205627,"standardDeviation":83.32157905402146,"values":[2562.824,2580.79,2652.74,2663.262,2719.864,2739.917,2751.632,2761.991,2779.526,2805.269]}{"framework":"target-keyed","keyed":true,"benchmark":"07_create10k","type":"cpu","min":2580.668,"max":2855.901,"mean":2792.7593,"median":2818.915,"geometricMean":2791.6674798837003,"standardDeviation":80.76562999891858,"values":[2580.668,2755.302,2776.434,2803.118,2815.78,2822.05,2836.38,2837.803,2844.157,2855.901]}==================
# {"framework":"baseline-keyed","keyed":true,"benchmark":"08_create1k-after1k_x2","type":"cpu","min":410.931,"max":455.785,"mean":442.43989999999997,"median":447.2975,"geometricMean":442.2248661298105,"standardDeviation":14.337400023481715,"values":[410.931,423.23,440.406,446.863,446.973,447.622,447.765,449.985,454.839,455.785]}{"framework":"target-keyed","keyed":true,"benchmark":"08_create1k-after1k_x2","type":"cpu","min":422.499,"max":482.061,"mean":456.2602,"median":457.8965,"geometricMean":455.93119792355714,"standardDeviation":18.169004655670534,"values":[422.499,438.73,441.681,454.298,456.765,459.028,460.136,471.418,475.986,482.061]}==================
# {"framework":"baseline-keyed","keyed":true,"benchmark":"09_clear1k_x8","type":"cpu","min":200.064,"max":255.596,"mean":242.8683,"median":246.8895,"geometricMean":242.35417302181506,"standardDeviation":15.849938472015175,"values":[200.064,236.849,245.212,246.044,246.812,246.967,247.502,251.134,252.503,255.596]}{"framework":"target-keyed","keyed":true,"benchmark":"09_clear1k_x8","type":"cpu","min":226.533,"max":255.073,"mean":248.5341,"median":251.67000000000002,"geometricMean":248.39202888625476,"standardDeviation":8.667279586660015,"values":[226.533,240.643,250.137,250.703,251.175,252.165,252.41,253.066,253.436,255.073]}==================
# {"framework":"baseline-keyed","keyed":true,"benchmark":"21_ready-memory","type":"memory","min":1.4216384887695312,"max":1.4216384887695312,"mean":1.4216384887695312,"median":1.4216384887695312,"geometricMean":1.4216384887695312,"standardDeviation":null,"values":[1.4216384887695312]}{"framework":"target-keyed","keyed":true,"benchmark":"21_ready-memory","type":"memory","min":0.9152259826660156,"max":0.9152259826660156,"mean":0.9152259826660156,"median":0.9152259826660156,"geometricMean":0.9152259826660156,"standardDeviation":null,"values":[0.9152259826660156]}==================
# {"framework":"baseline-keyed","keyed":true,"benchmark":"22_run-memory","type":"memory","min":1.7305870056152344,"max":1.7305870056152344,"mean":1.7305870056152344,"median":1.7305870056152344,"geometricMean":1.7305870056152344,"standardDeviation":null,"values":[1.7305870056152344]}{"framework":"target-keyed","keyed":true,"benchmark":"22_run-memory","type":"memory","min":1.6327934265136719,"max":1.6327934265136719,"mean":1.6327934265136719,"median":1.6327934265136719,"geometricMean":1.6327934265136719,"standardDeviation":null,"values":[1.6327934265136719]}==================
# {"framework":"baseline-keyed","keyed":true,"benchmark":"23_update5-memory","type":"memory","min":1.7308616638183594,"max":1.7308616638183594,"mean":1.7308616638183594,"median":1.7308616638183594,"geometricMean":1.7308616638183594,"standardDeviation":null,"values":[1.7308616638183594]}{"framework":"target-keyed","keyed":true,"benchmark":"23_update5-memory","type":"memory","min":1.6346702575683594,"max":1.6346702575683594,"mean":1.6346702575683594,"median":1.6346702575683594,"geometricMean":1.6346702575683594,"standardDeviation":null,"values":[1.6346702575683594]}==================
# {"framework":"baseline-keyed","keyed":true,"benchmark":"24_run5-memory","type":"memory","min":1.7390022277832031,"max":1.7390022277832031,"mean":1.7390022277832031,"median":1.7390022277832031,"geometricMean":1.7390022277832031,"standardDeviation":null,"values":[1.7390022277832031]}{"framework":"target-keyed","keyed":true,"benchmark":"24_run5-memory","type":"memory","min":1.7418785095214844,"max":1.7418785095214844,"mean":1.7418785095214844,"median":1.7418785095214844,"geometricMean":1.7418785095214844,"standardDeviation":null,"values":[1.7418785095214844]}==================
# {"framework":"baseline-keyed","keyed":true,"benchmark":"25_run-clear-memory","type":"memory","min":1.1360321044921875,"max":1.1360321044921875,"mean":1.1360321044921875,"median":1.1360321044921875,"geometricMean":1.1360321044921875,"standardDeviation":null,"values":[1.1360321044921875]}{"framework":"target-keyed","keyed":true,"benchmark":"25_run-clear-memory","type":"memory","min":1.2052268981933594,"max":1.2052268981933594,"mean":1.2052268981933594,"median":1.2052268981933594,"geometricMean":1.2052268981933594,"standardDeviation":null,"values":[1.2052268981933594]}==================
# {"framework":"baseline-keyed","keyed":true,"benchmark":"31_startup-ci","type":"startup","min":1729.7079999999999,"max":1883.6950000000002,"mean":1769.14675,"median":1731.592,"geometricMean":1767.9444726064294,"standardDeviation":76.37180841722083,"values":[1732.104,1729.7079999999999,1883.6950000000002,1731.08]}{"framework":"target-keyed","keyed":true,"benchmark":"31_startup-ci","type":"startup","min":1729.4560000000001,"max":1887.55,"mean":1808.30225,"median":1808.1014999999998,"geometricMean":1806.7207519835429,"standardDeviation":87.30961379815693,"values":[1880.1149999999998,1729.4560000000001,1887.55,1736.088]}==================
# {"framework":"baseline-keyed","keyed":true,"benchmark":"32_startup-bt","type":"startup","min":26.587999999999994,"max":34.71199999999999,"mean":29.18199999999999,"median":27.71399999999999,"geometricMean":29.004498738856363,"standardDeviation":3.834135104557479,"values":[28.82799999999999,26.587999999999994,34.71199999999999,26.59999999999999]}{"framework":"target-keyed","keyed":true,"benchmark":"32_startup-bt","type":"startup","min":25.987999999999996,"max":35.62799999999999,"mean":29.39699999999999,"median":27.98599999999999,"geometricMean":29.17044218534457,"standardDeviation":4.353438947161962,"values":[35.62799999999999,25.987999999999996,26.883999999999997,29.087999999999987]}==================
# {"framework":"baseline-keyed","keyed":true,"benchmark":"34_startup-totalbytes","type":"startup","min":308.8544921875,"max":308.8544921875,"mean":308.8544921875,"median":308.8544921875,"geometricMean":308.8544921875,"standardDeviation":0,"values":[308.8544921875,308.8544921875,308.8544921875,308.8544921875]}{"framework":"target-keyed","keyed":true,"benchmark":"34_startup-totalbytes","type":"startup","min":308.8544921875,"max":308.8544921875,"mean":308.8544921875,"median":308.8544921875,"geometricMean":308.8544921875,"standardDeviation":0,"values":[308.8544921875,308.8544921875,308.8544921875,308.8544921875]}
# benchmark:
#   name: Performance regression check
#   runs-on: ubuntu-latest

#   steps:
#     - uses: actions/checkout@v2
#     # - uses: actions/setup-go@v1
#     # Run benchmark with `go test -bench` and stores the output to a file
#     - name: Run benchmark
#       run: |
#         echo "{"framework":"baseline-keyed","keyed":true,"benchmark":"01_run1k","type":"cpu","min":175.313,"max":232.875,"mean":188.0121,"median":183.3795,"geometricMean":187.41571579204455,"standardDeviation":16.66508000747538,"values":[175.313,175.647,180.516,180.725,181.48,185.279,187.722,189.086,191.478,232.875]}{"framework":"target-keyed","keyed":true,"benchmark":"01_run1k","type":"cpu","min":179.49,"max":228.904,"mean":191.8154,"median":190.00799999999998,"geometricMean":191.35477355542594,"standardDeviation":14.552316311998046,"values":[179.49,180.738,181.109,182.696,188.2,191.816,192.596,194.888,197.717,228.904]}" > output.json
#     # gh-pages branch is updated and pushed automatically with extracted benchmark data
#     - name: Store benchmark result
#       uses: benchmark-action/github-action-benchmark@v1
#       with:
#         name: My Project Go Benchmark
#         tool: "customSmallerIsBetter"
#         output-file-path: output.txt
#         github-token: ${{ secrets.GITHUB_TOKEN }}
#         auto-push: true
#         comment-always: true
